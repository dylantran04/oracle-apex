SELECT 
    r.REQUEST_ID,
    r.REQUESTER,
    NVL(e1.full_name, r.TIER_1_APPROVAL) AS TIER_1_APPROVAL,
    r.TIER_1_STATUS,
    r.TIER_1_UPDATE_DATE,
    NVL(e2.full_name, r.TIER_2_APPROVAL) AS TIER_2_APPROVAL,
    r.TIER_2_STATUS,
    r.TIER_2_UPDATE_DATE,
    NVL(e3.full_name, r.TIER_3_APPROVAL) AS TIER_3_APPROVAL,
    r.TIER_3_STATUS,
    r.TIER_3_UPDATE_DATE,
    r.SLA_NOTE,
    r.SR_OWNER,
    r.SR_STATUS,
    r.SR_CREATER,
    r.DESCRIPTION,
    r.POLICY_LEAD,
    P.POLICY_NAME AS REQUEST_TYPE,
    r.SR_CLOSE_DATE,
    r.SR_START_DATE,
    r.SLA,
    r.PROCESS_STATUS,
    r.SR_CREATED_DATE,
    r.PROCESS_END_DATE,
    r.PROCESS_START_DATE
FROM 
    REQUEST r
LEFT JOIN 
    EMPLOYEE e1 ON r.TIER_1_APPROVAL = e1.email
LEFT JOIN 
    EMPLOYEE e2 ON r.TIER_2_APPROVAL = e2.email
LEFT JOIN 
    EMPLOYEE e3 ON r.TIER_3_APPROVAL = e3.email
LEFT JOIN 
    POLICY_AND_PROGRAM P ON r.REQUEST_TYPE = P.POLICY_ID
WHERE 
    r.SR_STATUS IS NOT NULL
    AND UPPER(r.REQUESTER) = UPPER(:APP_USER)
    -- and
    -- instr(':' || :FILSR_STATUS || ':' , ':' || SR_STATUS || ':') > 0 and SR_STATUS is not null
ORDER BY 
    r.SR_CREATED_DATE DESC;
